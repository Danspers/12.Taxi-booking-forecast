# Прогнозирование заказов такси

**Описание проекта:**

Компания **«Чётенькое такси»** собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Необходимо построить модель для такого предсказания. Значение метрики **RMSE** на тестовой выборке* должно быть **не больше 48**.

*тестовая выборка размером 10% от исходных данных.

## Общий вывод

**Исходный датасет** был перегруппирован: новый _временной интервал 1 час_. Все объекты за этот период были объединены и заказы просуммированы. _Дубликаты_ и _пропуски данных_ - отсутствовали. _Хронологичный порядок_ соблюден в течение всего периода: 1 марта 2018 - 31 августа 2018. Имевшиеся _выбросы_ (~1%) были заменены на максимальное значение, в пределах нормального распределения.

**Анализ данных**. _Тренды_, помимо пульсаций, имеют прослеживаемый линейный рост. _Сезонность_ имеет одинаковую повторяемость: суточную, недельную и месячную, но в слабо выраженная. Это позволило определить перечень признаков и их размеры:
- сдвиг (количество заказов за 2 предыдущих часов);
- скользящее среднее (среднее количество заказов за 3 ближайших часа);
- месяц;
- день месяца;
- день недели;
- час.

Получившаяся выборка относительно небольшая и для подбора гиперпараметров моделей использовалась _кросс вылидация_, с учётом хронологического порядка. Были обучены три модели:
- _Линейная регрессия_ (Linear Regression);
- _Случайный лес_ (Random Forest Regressor);
- _Модель градиентный бустинг_ (Light GBM), которая показала лучшей. **Результат на тестовой выборке**: время обучение 84 мс. и предсказания 5 мс., RMSE: 37.2. Большую часть временного ряда получается предсказать, за исключение выбросов.

![График фактических и предсказанных заказов](https://github.com/danspers/12.Taxi-booking-forecast/raw/main/graph_of_prediction_and_target.jpg)

## Примечание

Исходя из небольшого времени, требуемого для предсказания есть возможность снизить погрешность - уменьшив временной интервал, вернуться к исходному шагу в 10 минут. Данные, используемые в этом проекте, подойдут для этой задачи. К тому же следует уточнить первопричину появление выбросов. Это поможет понять как их обрабатывать и предсказывать.